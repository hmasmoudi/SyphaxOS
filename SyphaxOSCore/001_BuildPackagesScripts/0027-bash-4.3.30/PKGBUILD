# Maintainer: Hatem Masmoudi <hatem.masmoudi@gmail.com>

pkgname=bash
pkgver=4.3.30
pkgrel=1
pkgdesc="The Bash package contains the Bourne-Again SHell."
arch=('x86_64')
url="http://ftp.gnu.org/gnu/bash"
license=('GPL')
groups=('core')
source=("$url/$pkgname-$pkgver.tar.gz")
md5sums=('a27b3ee9be83bd3ba448c0ff52b28447')
depends=('rootfs>=1.0.0')

prepare() {
        cd "$srcdir/$pkgname-$pkgver"
        
        patch -Np1 -i ../../bash-4.3.30-upstream_fixes-3.patch
}

build() {
        cd "$srcdir/$pkgname-$pkgver"
        
        ./configure --prefix=/usr                       \
                    --docdir=/usr/share/doc/bash-4.3.30 \
                    --without-bash-malloc               \
                    --with-installed-readline

        make
}

package() {
        cd "$srcdir/$pkgname-$pkgver"
        
        make DESTDIR="$pkgdir/" install

        mkdir -pv $pkgdir/bin
        mv -vf $pkgdir/usr/bin/bash $pkgdir/bin
}
