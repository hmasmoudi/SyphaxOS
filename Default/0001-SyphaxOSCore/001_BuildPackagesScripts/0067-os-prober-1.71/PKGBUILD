# Maintainer: Hatem Masmoudi <hatem.masmoudi@gmail.com>

pkgname=os-prober
pkgver=1.71
pkgrel=1
pkgdesc="Detect OSes and linux variants."
arch=('x86_64')
url="http://http.debian.net/debian/pool/main/o/$pkgname"
license=('GPL')
groups=('core')
source=("$url/${pkgname}_${pkgver}.tar.xz")
md5sums=('7c1a149d076ac10af31043ffb33ba658')
depends=('rootfs>=2.0.0')

prepare() {
   cd "$srcdir/$pkgname-$pkgver"
}

build() {
   cd "$srcdir/$pkgname-$pkgver"

   make
}

package() {
   cd "$srcdir/$pkgname-$pkgver"

   mkdir -p $pkgdir/var/lib/os-prober
   mkdir -p $pkgdir/usr/bin
   cp -r linux-boot-prober $pkgdir/usr/bin
   cp -r os-prober $pkgdir/usr/bin
   mkdir -p $pkgdir/usr/lib/os-prober
   cp -r newns $pkgdir/usr/lib/os-prober
   mkdir -p $pkgdir/usr/lib/linux-boot-probes/mounted
   cp -r linux-boot-probes/common/* $pkgdir/usr/lib/linux-boot-probes
   cp -r linux-boot-probes/mounted/common/* $pkgdir/usr/lib/linux-boot-probes/mounted
   cp -r linux-boot-probes/mounted/x86/* $pkgdir/usr/lib/linux-boot-probes/mounted
   mkdir -p $pkgdir/usr/lib/os-probes/mounted
   cp -r os-probes/common/* $pkgdir/usr/lib/os-probes
   cp -r os-probes/mounted/common/* $pkgdir/usr/lib/os-probes/mounted
   cp -r os-probes/mounted/x86/* $pkgdir/usr/lib/os-probes/mounted
   mkdir $pkgdir/usr/lib/os-probes/init
   cp -r os-probes/init/common/* $pkgdir/usr/lib/os-probes/init
   mkdir -p $pkgdir/usr/share/os-prober
   cp -r common.sh $pkgdir/usr/share/os-prober
   chmod +x $pkgdir/usr/share/os-prober/common.sh
}

