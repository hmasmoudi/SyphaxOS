# Maintainer: Hatem Masmoudi <hatem.masmoudi@gmail.com>

pkgname=totem
pkgver=3.26.0
pkgrel=4
pkgdesc="Videos is a video playback application designed to work with GNOME 3"
arch=('x86_64')
url="http://ftp.gnome.org/pub/gnome/sources/totem/3.26"
license=('GPL')
groups=('applications')
source=("$url/${pkgname}-${pkgver}.tar.xz")
sha256sums=('e32fb9a68097045e75c87ad1b8177f5c01aea2a13dcb3b2e71a0f9570fe9ee13')
depends=('rootfs'
         'libvdpau-va-gl'
         'clutter-gst'
         'glu'
         'v4l-utils'
         'libvpx'
         'orc'
         'gst-libav'
         'gst-plugins-good'
         'gst-plugins-bad'
         'gst-plugins-ugly')

prepare() {
   cd "$srcdir/${pkgname}-${pkgver}"
   
   #sed -i "/seems to be moved/s/^/#/" build-aux/ltmain.sh
}

build() {
   cd "$srcdir/${pkgname}-${pkgver}"
   
   meson build --prefix=/usr -Denable-nautilus=yes
   cd build
   ninja -j$(($(getconf _NPROCESSORS_ONLN)+1))
   
   #./configure \
   #    --prefix=/usr \
   #    --disable-static \
   #    --enable-nautilus
   
   # https://bugzilla.gnome.org/show_bug.cgi?id=655517
   #sed -i -e 's/ -shared / -Wl,-O1,--as-needed\0/g' libtool
  
   #make
}

package() {
   cd "$srcdir/${pkgname}-${pkgver}"
   
   cd build
   DESTDIR="${pkgdir}" ninja install
   #make DESTDIR="${pkgdir}" install
}

