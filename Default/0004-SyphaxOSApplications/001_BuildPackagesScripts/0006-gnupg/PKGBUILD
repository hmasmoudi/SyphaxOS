# Maintainer: Hatem Masmoudi <hatem.masmoudi@gmail.com>

pkgname=gnupg
pkgver=2.2.5
pkgrel=6
pkgdesc="The GnuPG package is GNU's tool for secure communication and data storage."
arch=('x86_64')
url="https://www.gnupg.org/ftp/gcrypt/gnupg"
license=('GPL')
install=${pkgname}.install
groups=('applications')
source=("$url/${pkgname}-${pkgver}.tar.bz2")
md5sums=('SKIP')
depends=('rootfs')

build() {
   cd "$srcdir/${pkgname}-${pkgver}"
   
   ./configure --prefix=/usr \
               --enable-symcryptrun   \
               --docdir=/usr/share/doc/gnupg-${pkgver}
   make
   
   makeinfo --html --no-split \
            -o doc/gnupg_nochunks.html doc/gnupg.texi
   makeinfo --plaintext       \
            -o doc/gnupg.txt           doc/gnupg.texi
}

package() {
   cd "$srcdir/${pkgname}-${pkgver}"
   
   make DESTDIR="${pkgdir}" install
   
   ln -s gpg "${pkgdir}"/usr/bin/gpg2
   ln -s gpgv "${pkgdir}"/usr/bin/gpgv2

   install -v -m755 -d ${pkgdir}/usr/share/doc/gnupg-${pkgver}/html
   install -v -m644    doc/gnupg_nochunks.html \
                       ${pkgdir}/usr/share/doc/gnupg-${pkgver}/html/gnupg.html
   install -v -m644    doc/*.texi doc/gnupg.txt \
                       ${pkgdir}/usr/share/doc/gnupg-${pkgver}
}

