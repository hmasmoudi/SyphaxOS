# Maintainer: Hatem Masmoudi <hatem.masmoudi@gmail.com>

pkgname=gst-libav
pkgver=1.12.1
pkgrel=1
pkgdesc="The GStreamer Libav package contains GStreamer plugins for Libav (a fork of FFmpeg)."
arch=('x86_64')
url="http://gstreamer.freedesktop.org/src/gst-libav"
license=('GPL')
groups=('applications')
source=("$url/${pkgname}-${pkgver}.tar.xz")
sha256sums=('55d7823fdf63195de991adfef32db4b8a8bef3cafa46115a951e590dc18a5077')
depends=('rootfs>=2.0.0')

build() {
   cd "$srcdir/${pkgname}-${pkgver}"
   
   ./configure --prefix=/usr --sysconfdir=/etc --localstatedir=/var --libexecdir=/usr/lib \
               --with-package-name="GStreamer Libav Plugins SyphaxOS" \
               --with-package-origin="http://gstreamer.freedesktop.org/src/gst-libav" \
               --enable-orc  \
               --disable-static

   # https://bugzilla.gnome.org/show_bug.cgi?id=655517
   sed -i -e 's/ -shared / -Wl,-O1,--as-needed\0/g' libtool
   
   make
}

package() {
   cd "$srcdir/${pkgname}-${pkgver}"
   
   make DESTDIR="${pkgdir}" install
}

