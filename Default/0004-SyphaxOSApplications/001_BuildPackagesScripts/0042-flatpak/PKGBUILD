# Maintainer: Hatem Masmoudi <hatem.masmoudi@gmail.com>

pkgname=flatpak
pkgver=0.9.98.2
pkgrel=2
pkgdesc="THE FUTURE OF APPLICATION DISTRIBUTION. Flatpak is the new framework for desktop applications on Linux."
arch=('x86_64')
url="https://github.com/flatpak/flatpak/releases/download/${pkgver}"
license=('GPL')
groups=('applications')
source=("$url/${pkgname}-${pkgver}.tar.xz")
sha256sums=('aa6bb50926af5ec1a3aa22d553b2a0eaa1a36bccfb095a9d747fef5d84cd0756')
depends=('rootfs' 'ostree' 'elfutils' 'bubblewrap')

prepare() {
   cd "$srcdir/${pkgname}-${pkgver}"
   
   sed -i "/seems to be moved/s/^/#/" ltmain.sh
}
build() {
   cd "$srcdir/${pkgname}-${pkgver}"
   
   ./configure --prefix=/usr --with-system-bubblewrap
   
   make
}

package() {
   cd "$srcdir/${pkgname}-${pkgver}"
   
   make DESTDIR="${pkgdir}" install
   
   chmod 700 "${pkgdir}"/usr/share/polkit-1/rules.d
}

