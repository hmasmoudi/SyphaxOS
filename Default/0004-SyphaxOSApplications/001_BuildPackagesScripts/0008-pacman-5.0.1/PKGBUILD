# Maintainer: Hatem Masmoudi <hatem.masmoudi@gmail.com>

pkgname=pacman
pkgver=5.0.1
pkgrel=1
pkgdesc="SyphaxOS Package Manager."
arch=('x86_64')
url="https://git.archlinux.org/pacman.git/snapshot"
license=('GPL')
groups=('applications')
install=${pkgname}.install
source=("$url/${pkgname}-${pkgver}.tar.xz"
        "pacman.install"
        "pacman.conf"
        "pub.key"
        "trustdb.gpg")
md5sums=('79d1418d4dff1c2903329ad61d989324'
         'a8f38a0e14f0ab65492cfc11076236f4'
         'cb2a7235c825d917fc538f20a41a6c0c'
         'afae51776eeb25edb91ec4b1b5aa5219'
         'af585fd1f02e18bef8a5fa5421747383')
depends=('rootfs>=2.0.0'
         'asciidoc>=8.6.9'
         'npth>=1.2'
         'libksba>=1.3.5'
         'libassuan>=2.4.3'
         'pinentry>=0.9.7'
         'gnupg>=2.1.15'
         'gpgme>=1.6.0'
         'fakeroot>=1.20.2'
)

prepare() {
   cd "$srcdir/${pkgname}-${pkgver}"
}

build() {
   cd "$srcdir/${pkgname}-${pkgver}"
   
   ./autogen.sh
   ./configure --prefix=/usr \
               --with-libcurl \
               --with-openssl \
               --with-gpgme \
               --with-pkg-ext=.pkg.tar.xz \
               --with-src-ext=.src.tar.xz
   make
}

package() {
   cd "$srcdir/${pkgname}-${pkgver}"
   
   make DESTDIR="${pkgdir}" install
   
   cp -rf ../../pub.key ${pkgdir}/usr/etc/pub.key
   cp -rf ../../trustdb.gpg ${pkgdir}/usr/etc/trustdb.gpg
   cp -rf ../../pacman.conf ${pkgdir}/usr/etc/pacman.conf
}

