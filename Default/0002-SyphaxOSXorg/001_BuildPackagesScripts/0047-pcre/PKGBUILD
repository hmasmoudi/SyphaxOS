# Maintainer: Hatem Masmoudi <hatem.masmoudi@gmail.com>

pkgname=pcre
pkgver=8.40
pkgrel=3
pkgdesc="The PCRE package contains Perl Compatible Regular Expression libraries."
arch=('x86_64')
url="ftp://ftp.csx.cam.ac.uk/pub/software/programming/pcre"
license=('GPL')
groups=('graphicslayer')
source=("$url/${pkgname}-${pkgver}.tar.bz2")
md5sums=('41a842bf7dcecd6634219336e2167d1d')
depends=('rootfs>=2.0.0')

prepare() {
   cd "$srcdir/$pkgname-$pkgver"
}

build() {
   cd "$srcdir/$pkgname-$pkgver"
   
   source /etc/profile.d/xorg.sh
   echo "Using XORG_PREFIX ($XORG_PREFIX) & XORG_CONFIG ($XORG_CONFIG)"

   ./configure --prefix=/usr                                \
               --docdir=/usr/share/doc/${pkgname}-${pkgver} \
               --enable-unicode-properties                  \
               --enable-pcre16                              \
               --enable-pcre32                              \
               --enable-pcregrep-libz                       \
               --enable-pcregrep-libbz2                     \
               --enable-pcretest-libreadline                \
               --disable-static
   make
}

package() {
   cd "$srcdir/$pkgname-$pkgver"
   
   mkdir -pv ${pkgdir}/lib
   
   #Make the package
   make DESTDIR="$pkgdir" install
   
   mv -v ${pkgdir}/usr/lib/libpcre.so.* ${pkgdir}/lib
   ln -sfv ../../lib/libpcre.so.1 ${pkgdir}/usr/lib/libpcre.so
}

