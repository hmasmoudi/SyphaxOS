# Maintainer: Hatem Masmoudi <hatem.masmoudi@gmail.com>

pkgname=flatpak
pkgver=0.9.6
pkgrel=1
pkgdesc="THE FUTURE OF APPLICATION DISTRIBUTION. Flatpak is the new framework for desktop applications on Linux."
arch=('x86_64')
url="https://github.com/flatpak/flatpak/releases/download/${pkgver}"
license=('GPL')
groups=('applications')
source=("$url/${pkgname}-${pkgver}.tar.xz")
sha256sums=('d0835b70db8de97d3d3a6a57ecbc0bf8c69d308daa20897079634521e1949f9e')
depends=('rootfs>=2.0.0'
         'ostree>=2016.15'
         'elfutils>=0.168'
         'bubblewrap>=0.1.6')

prepare() {
   cd "$srcdir/${pkgname}-${pkgver}"
   
   sed -i "/seems to be moved/s/^/#/" ltmain.sh
}
build() {
   cd "$srcdir/${pkgname}-${pkgver}"
   
   ./configure --prefix=/usr --with-system-bubblewrap
   
   make
}

package() {
   cd "$srcdir/${pkgname}-${pkgver}"
   
   make DESTDIR="${pkgdir}" install
   
   chmod 700 "${pkgdir}"/usr/share/polkit-1/rules.d
}

